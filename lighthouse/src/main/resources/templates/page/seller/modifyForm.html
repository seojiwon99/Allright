<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
   xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layouts/insertModifyPro}">
<script src="https://code.jquery.com/jquery-latest.min.js"></script>
<!-- Content -->
<style type="text/css">
   .card-img-top {
      position: relative;
      width: 540px;
      height: 480px;
      margin: 0 auto;
   }

   .photo {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-repeat: no-repeat;
      background-position: center;
      background-size: cover;
      transition: transform .5s ease-out;
   }
      .modal {
      --bs-modal-width: 900px;
   }

  
</style>
<div layout:fragment="sellerContent">


  

     <div class="col-12 col-lg" style="background-color: #E7E9EB;">
          <div class="row">
              <h3 class="mb-10">상품 등록</h3>
          </div> 
         <div class="row">
            <div class="col-12 col-md-9 col-lg-8 offset-lg-1">
              <!-- Form -->
            <form id="updateForm" action="updateProduct" method="post" enctype="multipart/form-data">
            <input type="text" name="productCode" id="productCode" th:value="${product[0].productCode}" class="visually-hidden"/>
            <!-- <div th:each="code : ${product[0].option}">
            <input type="text" name="optionCode" id="optionCode" th:value="${code.optionCode}" class="visually-hidden"/>
            </div> -->
            <div class="row">
               <div class="col-12">
                  <!-- 카테고리 들어갈곳 -->
                  	<strong>현재 카테고리 * </strong><span class="form-control form-control-sm" th:text="${product[0].category[0].CategoryName}" style="width:200px; margin-bottom:10px;"></span>
                     <div class="form-group">
                        <label class="form-label">카테고리 선택 *</label>
                        <div class="row gx-5">
                           <div class="categorybox col-md-3">
                              <label class="visually-hidden" for="categoryCode">
                                 1단계 카테고리
                              </label>
                              <select class="form-select form-select-sm" id="categoryCode">
                                 <option value="1" class="disabledsel" disabled selected>카테고리선택</option>
                                 <option th:each="category : ${getCategoryList}" th:value="${category.categoryCode}"
                                    th:text="${category.categoryName}" th:if="${category.categoryLevel == 1}"></option>
                              </select>
                           </div>
                           <div class="categorybox1 col-md-3" style="display: none;">
                              <label class="visually-hidden" for="categoryCode01">
                                 2단계 카테고리
                              </label>
                              <select class="disabledsel form-select form-select-sm" id="categoryCode01">
                                 
                              </select>
                           </div>
                           <div class="categorybox2 col-md-3" style="display: none;">
                              <label class="visually-hidden" for="categoryCode02">
                                 3단계 카테고리
                              </label>
                              <select class="disabledsel form-select form-select-sm" id="categoryCode02">
                                 
                              </select>
                           </div>
                           <div class="categorybox3 col-md-3" style="display: none;">
                              <label class="visually-hidden" for="categoryCode03">
                                 4단계 카테고리
                              </label>
                              <select class="disabledsel form-select form-select-sm" id="categoryCode03">
                                 
                              </select>
                           </div>
                        </div>
                     </div>
                  </div>


            
                 <!-- 여기! -->
                  <div class="col-12">
                     <!-- 상품명 -->
                     <div class="form-group">
                        <label class="form-label" for="productName">
                           상품명 *
                        </label>
                        <input class="form-control form-control-sm" id="productName" type="email" placeholder="상품명을 입력해주세요" name="productName" maxlength="70" th:value="${product[0].productName}">
                     </div>
                  </div>
                  <div class="col-12 col-md-4">
                    <!-- 판매가 -->
                    <div class="form-group">
                      <label class="form-label" for="productCost">
                         판매가 *
                      </label>
                      <input class="form-control form-control-sm" type="number" id="productCost" name="productCost" maxlength="12" placeholder="판매가를 입력하세요" th:value="${product[0].productCost}">
                    </div>
  
                  </div>
                  <div class="col-12 col-md-4">
                    <!-- 할인가 -->
                    <div class="form-group">
                      <label class="form-label" for="accountLastName">
                        할인가 *
                      </label>
                      <input type="number" id="salePrice" name="salePrice" class="form-control form-control-sm" maxlength="12" placeholder="할인가를 입력해주세요" th:value="${product[0].salePrice}">
                    </div>
  
                  </div>
                  <div class="col-12 col-md-4">
                    <!-- 수량 -->
                    <div class="countdiv form-group">
                      <label class="form-label" for="productCount">
                        수량 *
                      </label>
                      <input type="number" id="productCount" name="productCount" class="form-control form-control-sm" maxlength="9" placeholder="재고수량을 입력해주세요">
                    </div>
  
                  </div>

               <div class="col-12 col-md-3">
                     <label class="form-label" for="accountPassword">
                        옵션 *
                     </label>
                  <div class="form-group input-group input-group-merge" id="optionPlz" readonly>
                     <input class="optionsel form-select form-select-sm" id="optCnt" name="optCnt" readonly>
                        <!-- <option value="0" selected>----</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option> -->
                     <div class="input-group-append">
                          <input type="hidden" value="N" id="optionNum" name="optionNum" readonly>
                          
                        </div>
                    </div>
               </div>
               <th:block th:each="option,index : ${product[0].option}" style="display:none;">
				    <input th:value="${option.optionName}" th:id="'optionNames'+${index.index}" style="display:none;">
				    <input th:value="${option.optionValue}" th:id="'optionValues'+${index.index}" style="display:none;">
				    <input th:value="${option.optionCode}" th:id="'optionCodes'+${index.index}" style="display:none;">
				</th:block>

                  
                  <div class="optionB col-12 col-lg" style="margin-bottom: 15px;">
                  
                  </div>


                  <div class="col-12">
                     <div class="tableWrapper form-group">
                        <table class="table table-bordered table-sm mb-0" style="background-color: white;" id="userListTable">
                        <thead>
                           <tr>
                              <th scope="col">옵션명</th>
                              <th scope="col">옵션가격</th>
                              <th scope="col">옵션수량</th>
                              <th scope="col">최소구매수량</th>
                              <th scope="col">최대구매수량</th>
                           </tr>
                        </thead>
                        <tbody id="optiontab">
							<tr th:each="pro, index : ${product[0].optionDetail}" th:if="${product[0].option[0].optionName != '없음'}">
							    <td><input type="text" th:name="'optionDetail[' + ${index.index} + '].optionLast'" th:id="'optionLast' + ${index.index} + ''" th:value="${pro.optionLast}"></td>
							    <td><input type="text" th:name="'optionDetail[' + ${index.index} + '].optionPrice'" th:id="'optionPrice' + ${index.index} + ''" th:value="${pro.optionPrice}"></td>
							    <td><input type="text" th:name="'optionDetail[' + ${index.index} + '].optionCount'" th:id="'optionCount' + ${index.index} + ''" th:value="${pro.optionCount}"></td>
							    <td><input type="text" th:name="'optionDetail[' + ${index.index} + '].minOrder'" th:id="'minOrder' + ${index.index} + ''" th:value="${pro.minOrder}"></td>
							    <td><input type="text" th:name="'optionDetail[' + ${index.index} + '].maxOrder'" th:id="'maxOrder' + ${index.index} + ''" th:value="${pro.maxOrder}"></td>
							    <td><input type="text" th:name="'optionDetail[' + ${index.index} + '].optionDetailCode'" th:id="'optionDetailCode' + ${index.index} + ''" th:value="${pro.optionDetailCode}" style="display:none;"></td>
							    <td><input type="text" th:name="'optionDetail[' + ${index.index} + '].optionSellStatus'" th:id="'optionSellStatus' + ${index.index} + ''" th:value="${pro.optionSellStatus}" style="display:none;"></td>
							
							</tr>
                        </tbody>
                     </table>
                  </div>
               </div>

               <div class="col-12 col-lg-12">
                     <div class="form-group mb-8">
                        <div class="input-group mb-3">
                           <label class="input-group-text" for="imgName">메인이미지</label>
                           <input type="file" class="form-control" id="imgName" name="files" accept="image/*" onchange="setThumbnail(event);">
                        </div>
                        <div id="image_container">
                           <div style="display:flex;">
								<img th:src="|/upload/${detailImg[0].uploadPath}/${detailImg[0].uploadName}|" style="width:200px; height:220px">
								<textarea name="productImg[0].imgContent" id="productImgCon" class="form-control" th:text="${detailImg[0].imgContent}"></textarea>
                           </div>
                        </div>
                     </div>
                </div>
                   
               <div class="col-12 col-lg-6">
                     <div class="form-group mb-8">
                       <label class="form-label">상세설명</label>
                       <div>
                         <input class="btn-check" type="button" name="detailBox" id="male" checked>
                         <label class="detailPro btn btn-sm btn-outline-border" for="detailBox">작성하러가기</label>
                       </div>
                     </div>
                   </div>
              <div class="col-12">
                     <!-- 상품명 -->
                     <div class="form-group">
                        <label class="form-label" for="productBrand">
                           브랜드 *
                        </label>
                        <input class="form-control form-control-sm" id="productBrand" type="text" placeholder="브랜드을 입력해주세요" name="productBrand" maxlength="30" th:value="${product[0].productBrand}">
                     </div>
                  </div>
                  <div class="col-12">
                     <!-- 상품명 -->
                     <div class="form-group">
                        <label class="form-label" for="productOrigin">
                           원산지 *
                        </label>
                        <input class="form-control form-control-sm" id="productOrigin" type="text" placeholder="원산지을 입력해주세요" name="productOrigin" maxlength="15" th:value="${product[0].productOrigin}">
                     </div>
                  </div>
                  <div class="col-12">
                     <!-- 상품명 -->
                     <div class="form-group">
                        <label class="form-label" for="productMakeorigin">
                           제조국 *
                        </label>
                        <input class="form-control form-control-sm" id="productMakeorigin" type="text" placeholder="제조국을 입력해주세요" name="productMakeorigin" maxlength="15" th:value="${product[0].productMakeorigin}">
                     </div>
                  </div>
                  <div class="col-12 col-md-4">
                     <!-- 판매가 -->
                     <div class="form-group">
                       <label class="form-label" for="deliveryCost">
                        기본배송비 *
                       </label>
                       <input class="form-control form-control-sm" type="number" id="deliveryCost" name="deliveryCost" maxlength="12" value="0" th:value="${product[0].deliveryCost}">
                     </div>
   
                   </div>
                   <div class="col-12 col-md-4">
                     <!-- 할인가 -->
                     <div class="form-group">
                       <label class="form-label" for="exchangeCost">
                        교환배송비 *
                       </label>
                       <input type="number" id="exchangeCost" name="exchangeCost" class="form-control form-control-sm" maxlength="12" value="0" th:value="${product[0].exchangeCost}">
                     </div>
   
                   </div>
                   <div class="col-12 col-md-4">
                     <!-- 할인가 -->
                     <div class="form-group">
                       <label class="form-label" for="returnCost">
                        반품배송비 *
                       </label>
                       <input type="number" id="returnCost" name="returnCost" class="form-control form-control-sm" maxlength="12" value="0" th:value="${product[0].returnCost}">
                     </div>
   
                   </div>
              <div class="col-12">
                    <!-- Button -->
                    <button type="submit" class="submit btn btn-primary">수정</button>
                  </div>
                </div>
              </form>
         </div>
      </div>
     <!-- Modal -->
      <div class="modal" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
         <div class="modal-dialog modal-lg">
            <div class="modal-content">
               <div class="modal-header">
                  <h1 class="modal-title fs-8" id="exampleModalLabel">미리보기</h1>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
               </div>
               <div class="modal-body">
                  <section>
                     <div class="container">
                        <div class="row">
                           <div class="col-12">
                              <div class="row">
                                 <div class="col-12 col-md-6">
                                    <!-- Slider -->
                                    <div class="flickity-nav mx-n2 mb-10 mb-md-0" style="height: 100%;">
                                       <div class="Mimg ratio-1x1 bg-cover" style="height: 100%;">
                                          <!-- 이미지 들어갈곳 -->
                                       </div>
                                    </div>
                                 </div>

                                 <div class="col-12 col-md-6 ps-lg-10">
                                    <!-- Header -->
                                    <div class="row mb-1">
                                       <div class="col">
                                          <!-- Preheading -->
                                          <a class="Mcate text-muted">카테고리 들어가는곳</a>
                                       </div>
                                       <div class="col-auto">
                                          <!-- Rating -->
                                          <div class="rating fs-xs text-dark">
                                             <div class="rating-item">
                                                <i class="fas fa-star"></i>
                                             </div>
                                             <div class="rating-item">
                                                <i class="fas fa-star"></i>
                                             </div>
                                             <div class="rating-item">
                                                <i class="fas fa-star"></i>
                                             </div>
                                             <div class="rating-item">
                                                <i class="fas fa-star"></i>
                                             </div>
                                             <div class="rating-item">
                                                <i class="fas fa-star"></i>
                                             </div>
                                          </div>
                                       </div>
                                    </div>

                                    <!-- Heading -->
                                    <h3 class="MproName mb-2"></h3>

                                    <!-- Price -->
                                    <div class="mb-7">
                                       <span
                                          class="Mprice fs-lg fw-bold text-gray-350 text-decoration-line-through"></span>
                                       <span class="MSale ms-1 fs-5 fw-bolder text-primary"></span>
                                    </div>

                                    <!-- Form -->
                                    <div class="form-group"
                                       style="font-size: 15px; border-bottom: 1px solid rgba(0, 0, 0, 0.3)">
                                       <div style="padding-bottom: 8px; color: grey">
                                          <span>배송정보 : </span> <span class="Mdelivery"></span>
                                       </div>
                                       <div style="padding-bottom: 8px; color: grey">
                                          <span>배송비 : </span> <span class="Mdelprice"></span>
                                       </div>
                                       <div style="padding-bottom: 8px; color: grey">
                                          <span>생산지 : </span> <span class="Mmaker"></span>
                                       </div>
                                    </div>


                                    <div class="form-group">
                                       <!-- Label -->

                                       <div class="mb-2" style="padding-bottom: 24px">
                                          <!-- option -->
                                          <div class="col-12 col-lg-auto">
                                             <div class="selectbox">
                                                <!-- <select class="selectbox form-select mb-2">
                                                   <option class="selectbox1" value=""> 옵션들어가는곳
                                                   </option>

                                                </select>
                                                <select class="selectbox1 form-select mb-2">
                                                   <option class="selectbox1" value=""> 옵션들어가는곳
                                                   </option>

                                                </select> -->
                                             </div>
                                          </div>
                                          <div class="col-12 col-lg-auto">
                                             <div
                                                style="display: flex; justify-content: space-between; padding: 20px 0px 40px 0px; color: black"
                                                class="num">

                                                <div>
                                                   <span style="font-size: 22px; color: grey" id="realPrice">합계:0</span>
                                                </div>
                                             </div>
                                          </div>
                                          <div class="row gx-5 mb-7">
                                             <div class="col-12 col-lg">
                                                <!-- Submit -->
                                                <button type="button" class="btn w-100 btn-dark mb-2">장바구니 <i
                                                      class="fe fe-shopping-cart ms-2"></i>
                                                </button>
                                             </div>
                                             <div class="col-12 col-lg-auto">
                                                <!-- Wishlist -->
                                                <button class="btn btn-outline-dark w-100 mb-2">
                                                   찜 <i class="fe fe-heart ms-2"></i>
                                                </button>

                                             </div>
                                          </div>

                                          <p>
                                             <span class="text-gray-500">아이디가 없나요?</span> <a
                                                class="text-reset text-decoration-underline" id="loginTag">지금
                                                바로 회원가입!</a>
                                          </p>
                                       </div>
                                    </div>
                                    <!-- Text -->

                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>
                  </section>

                  <!-- DESCRIPTION -->
                  <section class="pt-11">
                     <div class="container">
                        <div class="row">
                           <div class="col-12">
                              <!-- Nav -->
                              <div
                                 class="nav nav-tabs nav-overflow justify-content-start justify-content-md-center border-bottom"
                                 style="font-size: 24px; position: sticky; top: 0px; background-color: white; z-index: 1">
                                 <a class="menu nav-link">
                                    상세정보
                                 </a>
                                 <a class="menu nav-link">리뷰
                                    <strong class="fs-sm ms" name="reviewCount">(0)</strong>
                                 </a> <a class="menu nav-link">
                                    Q&A <strong class="fs-sm" name="inquiryCont">(0)</strong>
                                 </a>
                              </div>
                              <!-- Content -->
                              <div class="tab-content">
                                 <div class="">
                                    <div style="padding-top: 48px">
                                       <h5 class="mb-5 text-center">표기 정보</h5>
                                       <table class="table">
                                          <thead>
                                             <tr>
                                                <th scope="col" style="font-weight: 600">제품명</th>
                                                <th scope="col" class="MproName"></th>
                                                <th scope="row" style="font-weight: 600">판매자</th>
                                                <th scope="row" id="sellerId" class="sellerName"></th>
                                             </tr>
                                          </thead>

                                          <tbody>
                                             <tr>
                                                <th scope="row" style="font-weight: 600">사업자번호</th>
                                                <th scope="row" class="sellerNum"></th>
                                                <th scope="row" style="font-weight: 600">원가</th>
                                                <th scope="row" class="Mprice">원가 </th>
                                             </tr>
                                             <tr>
                                                <td scope="row" style="font-weight: 600">등록날짜</td>
                                                <td scope="row" class="today"></td>
                                             </tr>
                                             <tr>
                                                <td scope="row" style="font-weight: 600">배송방법</td>
                                                <td scope="row" class="Mdelivery">배송방법</td>
                                                <td scope="row" style="font-weight: 600">배송비</td>
                                                <td scope="row" class="Mdelprice">배송비</td>
                                             </tr>

                                             <tr>
                                                <td scope="row" style="font-weight: 600">생산지</td>
                                                <td scope="row" class="Mmaker">생산지</td>
                                             </tr>
                                          </tbody>
                                       </table>
                                    </div>

                                    <!-- 상세내용 -->
                                    <div style="padding: 48px 0px">
                                       <div class="Mdetail"></div>
                                    </div>
                                 </div>
                              </div>

                           </div>
                        </div>
                     </div>
                  </section>
</div>
				</div>

               </div>
               <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
               </div>
            </div>
         </div>
      <script th:inline="javascript">
      let productCode = window.localStorage.getItem('productCode');
         let test22="";
         console.log(productCode);
         
         $(window).on("load", function () {
             optbox = $('.optionN');
             optbox1 = $('.optionV');

          })
         
         
         $(document).ready(function () {
        	 
        	 $(window).on('beforeunload', (event) => {
         		const currentURL = test22;
  	   		    
         		if (currentURL !== '/modifyProductContent?productCode='+ productCode) {
         			return "페이지를 떠나시겠습니까? 변경사항이 저장되지 않을 수 있습니다.";
                }
  	   		  }); 
	 
        	 var val = [[${product[0].option.size}]];
			 let optionz = [[${product[0].option[0].optionName}]]
			 let optionc = [[${product[0].optionDetail[0].optionCount}]]
			 let optionSta = [[${product[0].optionDetail[0].optionSellStatus}]]
			 let tq = $('#optionValues1').val();
			// console.log(optionSta);
			 let optionNames = [];
             let optionValues = [];
             let optionCodes=[];
             for (var i = 0; i < val; i++) {
                let inputName = $('#optionNames'+[i]).val();
                let inputValue =$('#optionValues'+[i]).val();
                let inputOpCode = $('#optionCodes'+[i]).val();
                optionNames.push(inputName);
                optionValues.push(inputValue);
                optionCodes.push(inputOpCode);
             }

			 console.log(optionNames);
			 console.log(optionCodes);
			 console.log(optionc);
			 if(optionz == '없음' ){
				$('#optCnt').val(0); 
			 } 
			 else{
	            $('#optCnt').val(val);
			 }
             console.log(val);
                   // 옵션 input 창   
               
                if (val != 0 && optionz == '없음') {
                     $('.optionText').show();
                     $('#optionCount').val('');
                     $('#productCount').val('');
                     $('.countdiv').hide();
                  } else {
                     $('.optionText').hide();
                     $('.countdiv').show();
                     $('#productCount').val(optionc);
                  }

                if(optionz != '없음'){
                  for (let i = 0; i < val; i++) {
                     let divBox = $('<div/>');
                     let div = $('<div/>').addClass("optionDiv col input-group mb-3");
                     let span = $('<span/>');
                     span.text("옵션명"+ (i+1));
                     span.addClass("input-group-text");

                     div.append(span);
                     
                     
                     let optionN = $('<input name="option[' + i +
                        '].optionName" class="optionN form-control" type="text" id="optionName' + i + '"/>');
					if(optionz != '없음'){
                     optionN.val(optionNames[i]);
					}
                     
                     div.append(optionN);
                     $('.optionB').append(div);

                     div = $('<div/>').addClass("optionDiv col input-group mb-3");
                     span = $('<span/>');
                     span.text("옵션값"+ (i+1));
                     span.addClass("input-group-text");
                     div.append(span);
                     let optionV = $('<input name="option[' + i +
                        '].optionValue" class="optionV form-control" type="text" placeholder="ex) 파랑,노랑,초록" id="optionVal' + i +
                        '" />');
                     if(optionz != '없음'){
                     optionV.val(optionValues[i]);
                     }
                     
                     div.append(optionV);
                     
                     
                     let optionCodeInput =$('<input name="option[' + i +
                    	        '].optionCode" class="optionCode visually-hidden form-control" type="text" id="optionCode' + i + '" />');
                     
                     optionCodeInput.val(optionCodes[i]);
                     div.append(optionCodeInput);
                     
                     divBox.append(div);
                     $('.optionB').append(divBox);

                  }
                }
    
               
               
               
               
               
               
               
               
               
               
               // 옵션 input 창   
              /*  -
               $('.optionsel').on('change', function (e) {
            	   
                  let val = $(this).val();
                  
                  $('.optionB').children().remove();
                  $('#optiontab').children().remove();
                  if (val != 0) {
                     $('.optionText').show();
                     $('#optionCount').val('');
                     $('#productCount').val('');
                     $('.countdiv').hide();
                  } else {
                     $('.optionText').hide();
                     $('.countdiv').show();
                  }


                  for (let i = 0; i < val; i++) {
                     let divBox = $('<div/>');
                     let div = $('<div/>').addClass("optionDiv col input-group mb-3");
                     let span = $('<span/>');
                     span.text("옵션명"+ (i+1));
                     span.addClass("input-group-text");
						
                     div.append(span);
                     let optionN = $('<input name="option[' + i +
                        '].optionName" class="optionN form-control" type="text" id="optionName' + i + '"/>');
                     if (optionz != '없음') {
                     optionN.val(optionNames[i]);
                     }
                     // let div = $('<div/>').addClass("optionDiv col-md-6");
                     // let labelN = $("<label> /").text("옵션이름");
                     // let optionN = $('<input name="option[' + i +
                     //    '].optionName" class="optionN form-control" type="text" id="optionName' + i + '"/>');
                     div.append(optionN);
                     $('.optionB').append(div);

                     div = $('<div/>').addClass("optionDiv col input-group mb-3");
                     span = $('<span/>');
                     span.text("옵션값"+ (i+1));
                     span.addClass("input-group-text");
                     div.append(span);
                     let optionV = $('<input name="option[' + i +
                        '].optionValue" class="optionV form-control" type="text" placeholder="ex) 파랑,노랑,초록" id="optionVal' + i +
                        '" />');
                     if (optionz != '없음') {
                     optionV.val(optionValues[i]);
                     }
                     div.append(optionV);
                     divBox.append(div);
                     $('.optionB').append(divBox);

                  }
               })
 */
         


        	 let userData = JSON.parse(localStorage.getItem("product"));
             let detailData = JSON.parse(localStorage.getItem("detail"));
             console.log(detailData);
             if (userData != null) {
                if (Date.now() > userData.expire) {
                   localStorage.removeItem("product");
                   localStorage.removeItem("detail");
                   return;
                }
                let inputTag = $("#updateForm").find("input").not("[type='button']").not("[type='file']");
                // let selectTag = $("#insertForm").find("select");
                // for (let i = 0; i < selectTag.length; i++) {
                //    inputTag.push(selectTag[i]);
                // }

                $.each(userData, function (key, value) {
                   // console.log(key);
                   for (let data of inputTag) {
                      let dataName = $(data).attr('name');
                      if (dataName == key) {
                         $(data).val(value);
                         // if (dataName == 'optCnt' && $(data).val() != '') {
                         //    let val = $(data).val();
                         //    console.log(val);
                         //    $('.optionB').children().remove();
                         //    // console.log(val);
                         //    if (val != 0) {
                         //       $('.optionBox').show();
                         //    } else {
                         //       $('.optionBox').hide();
                         //    }
                         //    console.log(key);
                         //    for (let i = 0; i < val; i++) {
                         //       console.log(option[i].value);
                         //       let div = $('<div/>').addClass("optionDiv col-md-6");
                         //       let labelN = $("<label> /").text("옵션이름");
                         //       let optionN = $('<input name="option[' + i +
                         //          '].optionName1" class="optionN" type="text" id="optionName' + i +
                         //          '"/ value="' + key[i].value + '">');
                         //       div.append(labelN);
                         //       div.append(optionN);
                         //       $('.optionB').append(div);


                         //       let labelV = $("<label/>").text("옵션");
                         //       let optionV = $('<input name="option[' + i +
                         //          '].optionValue1" class="optionV" type="text" placeholder="ex) 파랑,노랑,초록" id="optionVal' +
                         //          i + '" />');
                         //       div.append(labelV);
                         //       div.append(optionV);
                         //       $('.optionB').append(div);

                         //    }
                         // }
                      }

                   }


                })
                if (userData.deliveryService != '') {
                   $('#deliveryService').val(userData.deliveryService);
                }
                if (userData.optCnt != 0) {
                    $('.optionText').show();
                    $('#optCnt').val(userData.optCnt);
                    for (let i = 0; i < userData.optCnt; i++) {
                       let div = $('<div/>').addClass("optionDiv col-md-6");
                       let labelN = $("<label> /").text("옵션이름");
                       let optionN = $('<input name="option[' + i +
                          '].optionName" class="optionN" type="text" id="optionName' + i +
                          '"/ value="' + userData.option[i].optionName1 + '">');
                       div.append(labelN);
                       div.append(optionN);
                       $('.optionB').append(div);


                       let labelV = $("<label/>").text("옵션");
                       let optionV = $('<input name="option[' + i +
                          '].optionValue" class="optionV" type="text" placeholder="ex) 파랑,노랑,초록" id="optionVal' +
                          i + '"   value="' + userData.option[i].optionValue1 + '" />');
                       div.append(labelV);
                       div.append(optionV);
                       $('.optionB').append(div);

                    }
                 }

               /*  if (userData.imgInfo !== "") {
                    
                    console.log("asd");
                    let div = $("div#image_container");
                    let img = $("<img/>");
                    $(img).attr('src', userData.imgInform);
                    $(img).css("width", "300px");
                    $(img).css("height", "300px");
                    let divTag = $("<div />");

                    divTag.append(img);
                    let inputTag = $('<input/>');
                    $(inputTag).val(userData.imgInform);
                    $(inputTag).attr('id', "Imginform");

                    let textarea = $('textarea');
                    $(textarea).attr("name", "productImg[0].imgContent");

                    divTag.append(textarea);
                    divTag.append(inputTag);

                    div.append(divTag);
                 } */

                 if(Object.keys(userData.catemenu[0]).length != 0){
                    let obj = userData.catemenu[0];
                    let keyword ='';
                    let seloption 
                    let select = $('#categoryCode');
                    for(var key in obj){
                       if(key.charAt(0) == 0){
                          keyword = key.substr(1);
                          keyval = obj[key];
                       }
                    }

                    $('#categoryCode01').attr("name","categoryCode");
                   
                    $(select).val(keyval);
                   
                 }

                 if(Object.keys(userData.catemenu[1]).length != 0){
                    // console.log("asdafff");
                    $('.categorybox1').css('display','block');

                    let obj = userData.catemenu[1];
                    let keyword ='';
                    let select = $('#categoryCode01');
                    for(var key in obj){
                       //console.log(key);
                       if(key.charAt(0) == 0){
                          keyword = key.substr(1);
                          keyval = obj[key];
                          let opt = $('<option>' + keyword + '</option>');
                          opt.attr('value', keyval);
                          opt.attr('class', 'optionBox');
                          opt.prop("selected",true);
                          select.append(opt);
                       }else{
                          let opt = $('<option>' + key + '</option>');
                          opt.attr('value', obj[key]);
                          opt.attr('class', 'optionBox');
                          select.append(opt);
                       }
                    }

                    if(Object.keys(userData.catemenu[2]).length != 0){
                       $('#categoryCode').removeAttr("name");
                       $('#categoryCode01').removeAttr("name");
                       $('#categoryCode02').attr("name","categoryCode");
                       $('#categoryCode03').removeAttr("name");
                    }
                 }

                 //console.log(Object.keys(userData.catemenu[2]).length);
                 if(Object.keys(userData.catemenu[2]).length != 0){
                    //console.log("a333333333333");
                    $('.categorybox2').css('display','block');

                    let obj = userData.catemenu[2];
                    let keyword ='';
                    let select = $('#categoryCode02');
                    for(var key in obj){
                       //console.log(key);
                       if(key.charAt(0) == 0){
                          keyword = key.substr(1);
                          keyval = obj[key];
                          let opt = $('<option>' + keyword + '</option>');
                          opt.attr('value', keyval);
                          opt.attr('class', 'optionBox');
                          opt.prop("selected",true);
                          select.append(opt);
                       }else{
                          let opt = $('<option>' + key + '</option>');
                          opt.attr('value', obj[key]);
                          opt.attr('class', 'optionBox');
                          select.append(opt);
                       }
                    }
                    if(Object.keys(userData.catemenu[3]).length != 0){
                       
                       $('#categoryCode').removeAttr("name");
                       $('#categoryCode01').removeAttr("name");
                       $('#categoryCode02').removeAttr("name");
                       $('#categoryCode03').attr("name","categoryCode");
                    }
                 }

                 if(Object.keys(userData.catemenu[3]).length != 0){
                    //console.log("444444444444444");
                    $('.categorybox3').css('display','block');

                    let obj = userData.catemenu[3];
                    let keyword ='';
                    let select = $('#categoryCode03');
                    for(var key in obj){
                       //console.log(key);
                       if(key.charAt(0) == 0){
                          keyword = key.substr(1);
                          keyval = obj[key];
                          let opt = $('<option>' + keyword + '</option>');
                          opt.attr('value', keyval);
                          opt.attr('class', 'optionBox');
                          opt.prop("selected",true);
                          select.append(opt);
                       }else{
                          let opt = $('<option>' + key + '</option>');
                          opt.attr('value', obj[key]);
                          opt.attr('class', 'optionBox');
                          select.append(opt);
                       }
                    }
                 }

              }
              if(detailData != null){
                 let formT = $('#insertForm');
                 console.log(formT);
                 if(detailData.content != null || detailData.content != ''){
                    let textarea = $('<textarea>'+ detailData.content +'</textarea>');
                    textarea.css("display","none");
                    textarea.attr("name","productContent");
                    $(formT).prepend(textarea);
                 }

                 if(detailData.img.length != 0){
                    for(let i = 0; i<detailData.img.length; i++){
                       let divTab = $('<div/>');
                       let obj = detailData.img[i];
                       console.log(obj);
                       for(var key in obj){
                          let input = $('<input/>');
                          $(input).val(obj[key]);
                          input.attr("type", "hidden");
                          input.attr("name","imgsVO["+i+"]."+key);
                          divTab.append(input);
                       }
                       $(divTab).appendTo(formT);
                       
                    }
                 }
              }

        
           })
          // 옵션 input 창   
          -
      //     $('.optionsel').on('change', function (e) {
      //         let val = $(this).val();
      //         $('.optionB').children().remove();
      //         // console.log(val);
      //         if (val != 0) {
      //            $('.optionText').show();
      //            $('#optionCount').val('');
      //            $('.countdiv').hide();
      //         } else {
      //            $('.optionText').hide();
      //            $('.countdiv').show();
      //         }
      //         for (let i = 0; i < val; i++) {
      //            let div = $('<div/>').addClass("optionDiv col-md-6");
      //            let labelN = $("<label> /").text("옵션이름");
      //            let optionN = $('<input name="option[' + i +
      //               '].optionName" class="optionN" type="text" id="optionName' + i + '"/>');
      //            div.append(labelN);
      //            div.append(optionN);
      //            $('.optionB').append(div);


      //            let labelV = $("<label/>").text("옵션");
      //            let optionV = $('<input name="option[' + i +
      //               '].optionValue" class="optionV" type="text" placeholder="ex) 파랑,노랑,초록" id="optionVal' + i +
      //               '" />');
      //            div.append(labelV);
      //            div.append(optionV);
      //            $('.optionB').append(div);

      //         }
      //      })





        $(document).on('change','#categoryCode', function (e) {
           let val = $(this).val();
           let cateBox = [[${getCategoryList}]];
           console.log("cateBox :" + val);
           let option = $('#categoryCode01');
           $('.optionBox').remove();
           $('.optionBox01').remove();
           $('.optionBox02').remove();
           $('.categorybox1').css('display', 'block');
           $('.categorybox2').css('display', 'none');
           $('.categorybox3').css('display', 'none');
           $('#categoryCode01').val(1);
           $('#categoryCode02').val(1);
           $('#categoryCode03').val(1);
           $('#categoryCode01').removeAttr('name');
           $('#categoryCode02').removeAttr('name');
           $('#categoryCode03').removeAttr('name');

           $('#categoryCode01').attr("name","categoryCode");

           // $('.disabledsel:eq(0)').attr("selected", "selected");
           // console.log(option);
           // console.log(cateBox);
           let firoption = $('<option>' + "카테고리선택" + '</option>');
           firoption.attr('value', 1);
           firoption.addClass("optionBox");
           firoption.prop("selected", true);

           firoption.prop("disabled", true);
           // firoption.attr("disabled");
           option.append(firoption);
           $(cateBox).each(function (idx, item) {
              // console.log(item);
              if (item.parentCategoryCode == val) {
                 let opt = $('<option>' + item.categoryName + '</option>');
                 opt.attr('value', item.categoryCode);
                 opt.attr('class', 'optionBox');

                 option.append(opt);
              }
           })
           // $('.disabledsel').attr("selected", "selected");
        })

        $(document).on('change', '#categoryCode01', function () {

           let val = $(this).val();

           $('#categoryCode02').val(1);

           let cateBox = [[${getCategoryList}]];
           let option = $('#categoryCode02');
           $('.optionBox01').remove();
           $('.optionBox02').remove();
           
           
           let num = 0;
           $(cateBox).each(function (idx, item) {

              if (item.parentCategoryCode == val) {
                 let opt = $('<option>' + item.categoryName + '</option>');
                 opt.attr('class', 'optionBox01');
                 opt.attr('value', item.categoryCode);

                 option.append(opt);
                 num++
              }
              // console.log(num);
           })
           if (num != 0) {
              $('.categorybox2').css('display', 'block');
              $('.categorybox3').css('display', 'none');
              $('#categoryCode01').removeAttr('name');
              $('#categoryCode02').attr('name', 'categoryCode');
              let firoption = $('<option>' + "카테고리선택" + '</option>');
              firoption.attr('value', 1);
              firoption.prop("selected", true);
              firoption.prop("disabled", true);

              firoption.addClass("optionBox01");
              
              option.prepend(firoption);
           } else {
              console.log("Asdasdaffff");

              $('#categoryCode01').attr('name', 'categoryCode');
              $('#categoryCode02').removeAttr('name');
              $('#categoryCode03').children().remove();

              $('.categorybox2').css('display', 'none');

           }
        })

        $(document).on('change', '#categoryCode02', function () {
           let val = $(this).val();
           // console.log(val);
           let cateBox = [[${getCategoryList}]];
           let option = $('#categoryCode03');
           $('.optionBox02').remove();
           $('#categoryCode03').val(1);
           let num = 0;
          
           $(cateBox).each(function (idx, item) {
              // console.log(item);
              if (item.parentCategoryCode == val) {
                 let opt = $('<option>' + item.categoryName + '</option>');
                 opt.attr('class', 'optionBox02');
                 opt.attr('value', item.categoryCode);

                 option.append(opt);
                 num++
              }
           })
           if (num != 0) {
              let firoption = $('<option>' + "카테고리선택" + '</option>');
              firoption.attr('value', 1);
              firoption.prop("selected", true);
              firoption.prop("disabled", true);
              firoption.addClass("optionBox02");
              option.prepend(firoption);
              $('.categorybox3').css('display', 'block');
              $('#categoryCode02').removeAttr('name');
              $('#categoryCode03').attr('name', 'categoryCode');
           } else {
              $('.categorybox3').css('display', 'none');
           }
        })

 		 $(document).on('click', '.submit', function (e) {
            let option = $("input[name='optionName']").val();
            console.log(option);
            e.preventDefault();
            // if($('#selectCategory').val() == null || $('#selectCategory').val() == '' ){
            //    alert("카테고리를 선택해주세요");   
            //    return;
            // }
            let form = $('#updateForm');
            let data = $(form).find('input[type != hidden]');
            /* $(data).each(function(idx,item){
               if($(item).val() == null || $(item).val() == ''){
                  let id = $(item).attr("id");

                  // console.log($(item).attr("id"));
                  alert( $('label[for="'+ id+'"]').text()  + "를 입력해주세요");
                  item.focus();
                  return false;
               }
            })

            if($('#selectdelivery').val() == null || $('#selectdelivery').val() ==''){
               alert("택배사를 선택 해주세요");
               return;
            } */
            test22 ='/modifyProductContent?productCode='+ productCode
            localStorage.removeItem('product')
            form.submit();
            

         })

       


       // 이미지 미리보기
       function setThumbnail(event) {
          var reader = new FileReader();

          reader.onload = function (event) {
             // console.log(event.target.result);
             // document.querySelector("div#image_container").removeChild();
             var div = document.querySelector("div#image_container");
             div.innerHTML ="";
             var divTag = document.createElement("div");
             divTag.style.display = "flex";
             var img = document.createElement("img");
             img.setAttribute("src", event.target.result);
             img.style.width = "300px";
             img.style.height = "300px";
             divTag.append(img);
             var srcinput = document.createElement('input');
             srcinput.value = event.target.result;
             srcinput.id = 'Imginform';
             srcinput.setAttribute("type","hidden");
             var input = document.createElement('input');
             var textarea = document.createElement("textarea");
             textarea.setAttribute("name", "productImg[0].imgContent");
             textarea.setAttribute("class","form-control");
             textarea.setAttribute("id", "productImgCon");
             
             divTag.append(textarea);
             divTag.append(srcinput);
             document.querySelector("div#image_container").append(divTag)

          };

          reader.readAsDataURL(event.target.files[0]);
       }

       $('#addOption').on('click', function (e) {
          if($('#optCnt').val() == 0){
             alert("등록하실 옵션이 없습니다.")
          }else{

             /* $('#optiontab').empty(); */
             let optionD = $('.optionDiv');
             let optionN = $('.optionN');
             let optionV = $('.optionV');
             let tbody = $('#optiontab');
 
             let arr = [];
 
             for (let i = 0; i < optionV.length; i++) {
                let optionLength = $(optionV[i]).val();
                let optionVal = optionLength.split(',');
                arr.push(optionVal);
             }
             let box0 = arr[0];
             let box1 = arr[1];
             let box2 = arr[2];
 
             if (optionV.length == 1) {
                let idx = 0;
                for (let i = 0; i < box0.length; i++) {
                   let tr = $('<tr/>');
 
                   td = $('<td/>');
                   input = $('<input />').attr('value', box0[i]);
                   input.attr('name', 'optionDetail[' + i + '].optionLast');
                   input.attr('id', 'optionLast' + idx);
                   input.attr('readonly', 'true');
                   td.append(input);
                   tr.append(td);
 
                   td = $('<td/>');
                   let inputN = $('<input />').attr('type', 'number');
                   inputN.attr('name', 'optionDetail[' + i + '].optionPrice');
                   inputN.attr('id', 'optionPrice' + idx);
                   inputN.css("width", "100px");
                   inputN.attr('value', 0);
                   td.append(inputN);
                   tr.append(td);
 
                   td = $('<td/>');
                   inputN = $('<input />').attr('type', 'number');
                   inputN.attr('name', 'optionDetail[' + i + '].optionCount');
                   inputN.attr('id', 'optionCount' + idx);
                   inputN.css("width", "100px");
                   inputN.attr('value', 0);
                   td.append(inputN);
                   tr.append(td);
 
                   td = $('<td/>');
                   inputN = $('<input />').attr('type', 'number');
                   inputN.attr('name', 'optionDetail[' + i + '].minOrder');
                   inputN.attr('id', 'minOrder' + idx);
                   inputN.css("width", "100px");
                   inputN.attr('value', 0);
                   td.append(inputN);
                   tr.append(td);
 
                   td = $('<td/>');
                   inputN = $('<input />').attr('type', 'number');
                   inputN.attr('name', 'optionDetail[' + i + '].maxOrder');
                   inputN.attr('id', 'maxOrder' + idx);
                   inputN.css("width", "100px");
                   inputN.attr('value', 0);
                   td.append(inputN);
                   tr.append(td);
                   
                  
                   
                   tbody.append(tr);
                   idx++;
                }
             } else if (optionV.length == 2) {
                let idx = 0;
                for (let i = 0; i < box0.length; i++) {
                   for (let j = 0; j < box1.length; j++) {
                      let tr = $('<tr/>');
 
                      td = $('<td/>');
                      input = $('<input />').attr('value', box0[i] + box1[j]);
                      input.attr('name', 'optionDetail[' + idx + '].optionLast');
                      input.attr('id', 'optionLast' + idx);
                      input.attr('readonly', 'true');
                      td.append(input);
                      tr.append(td);
 
                      td = $('<td/>');
                      let inputN = $('<input />').attr('type', 'number');
                      inputN.attr('name', 'optionDetail[' + idx + '].optionPrice');
                      inputN.attr('id', 'optionPrice' + idx);
                      inputN.css("width", "100px");
                      inputN.attr('value', 0);
                      td.append(inputN);
                      tr.append(td);
 
                      td = $('<td/>');
                      inputN = $('<input />').attr('type', 'number');
                      inputN.attr('name', 'optionDetail[' + idx + '].optionCount');
                      inputN.attr('id', 'optionCount' + idx);
                      inputN.css("width", "100px");
                      inputN.attr('value', 0);
                      td.append(inputN);
                      tr.append(td);
 
                      td = $('<td/>');
                      inputN = $('<input />').attr('type', 'number');
                      inputN.attr('name', 'optionDetail[' + idx + '].minOrder');
                      inputN.attr('id', 'minOrder' + idx);
                      inputN.css("width", "100px");
                      inputN.attr('value', 0);
                      td.append(inputN);
                      tr.append(td);
 
                      td = $('<td/>');
                      inputN = $('<input />').attr('type', 'number');
                      inputN.attr('name', 'optionDetail[' + idx + '].maxOrder');
                      inputN.attr('id', 'maxOrder' + idx);
                      inputN.css("width", "100px");
                      inputN.attr('value', 0);
                      td.append(inputN);
                      tr.append(td);
                      tbody.append(tr);
 
                      idx++;
                   }
                }
             } else if (optionV.length == 3) {
                let idx = 0;
                for (let i = 0; i < box0.length; i++) {
                   for (let j = 0; j < box1.length; j++) {
                      for (let x = 0; x < box2.length; x++) {
                         let tr = $('<tr/>');
 
                         td = $('<td/>');
                         input = $('<input />').attr('value', box0[i] + box1[j] + box0[x]);
                         input.attr('name', 'optionDetail[' + idx + '].optionLast');
                         input.attr('id', 'optionLast' + idx);
                         input.attr('readonly', 'true');
                         td.append(input);
                         tr.append(td);
 
                         td = $('<td/>');
                         let inputN = $('<input />').attr('type', 'number');
                         inputN.attr('name', 'optionDetail[' + idx + '].optionPrice');
                         inputN.attr('id', 'optionPrice' + idx);
                         inputN.css("width", "100px");
                         inputN.attr('value', 0);
                         td.append(inputN);
                         tr.append(td);
 
                         td = $('<td/>');
                         inputN = $('<input />').attr('type', 'number');
                         inputN.attr('name', 'optionDetail[' + idx + '].optionCount');
                         inputN.attr('id', 'optionCount' + idx);
                         inputN.css("width", "100px");
                         inputN.attr('value', 0);
                         td.append(inputN);
                         tr.append(td);
 
                         td = $('<td/>');
                         inputN = $('<input />').attr('type', 'number');
                         inputN.attr('name', 'optionDetail[' + idx + '].minOrder');
                         inputN.attr('id', 'minOrder' + idx);
                         inputN.css("width", "100px");
                         inputN.attr('value', 0);
                         td.append(inputN);
                         tr.append(td);
 
                         td = $('<td/>');
                         inputN = $('<input />').attr('type', 'number');
                         inputN.attr('name', 'optionDetail[' + idx + '].MaxOrder');
                         inputN.attr('id', 'maxOrder' + idx);
                         inputN.css("width", "100px");
                         inputN.attr('value', 0);
                         td.append(inputN);
                         tr.append(td);
                         tbody.append(tr);
                      }
                   }
                }
             }
 
             // for(let i = 0; i < optionD.length; i++){
             //    let optionN = $(optionD[i]).children('.optionN').val();
             //    let optionV = $(optionD[i]).children('.optionV').val();
             //    let optionVal = optionV.split(',');
 
             //    for(let j = 0; j < optionVal.length; j++){
 
             //       let tr = $('<tr/>');
             //       td = $('<td />');
             //       let input = $('<input />').attr('value', optionN);
             //       input.attr('name','option['+idx+'].optionName');
             //       input.attr('readonly','true');
             //       td.append(input);
             //       tr.append(td);
 
             //       td = $('<td/>');
             //       input = $('<input />').attr('value', optionVal[j]);
             //       input.attr('name','option['+idx+'].optionValue');
             //       input.attr('readonly','true');
             //       td.append(input);
             //       tr.append(td);
 
             //       // td = $('<td/>');
             //       // let inputN = $('<input />').attr('type','number');
             //       // inputN.attr('name','option['+idx+'].optionCount');
             //       // inputN.attr('id','option['+idx+'].optionCount'+j);
             //       // td.append(inputN);
             //       // tr.append(td);
 
             //       // td = $('<td/>');
             //       // inputN = $('<input />').attr('type','number');
             //       // inputN.attr('name','option['+idx+'].optionPrice');
             //       // inputN.attr('id','option['+idx+'].optionPrice'+j);
             //       // td.append(inputN);
             //       // tr.append(td);
 
             //       idx++;
             //       tbody.append(tr);
             //    }
             // }
          }

       })

             

         // localstorage에 담고 보내기
         $('.detailPro').on('click', function (e) {
            // localstorage 저장
            localStorage.removeItem('product');
            e.preventDefault();

            let obj = {
               productName: $('input[name="productName"]').val(),
               productCost: $('input[name="productCost"]').val(),
               salePrice: $('input[name="salePrice"]').val(),
               productCount: $('input[name="productCount"]').val(),
               files: $('input[name="files"]').val(),
               productBrand: $('input[name="productBrand"]').val(),
               optCnt: $('select[name="optCnt"]').val(),
               unitsInStock: $('input[name="unitsInStock"]').val(),
               productOrigin: $('input[name="productOrigin"]').val(),
               productMakeorigin: $('input[name="productMakeorigin"]').val(),
               minOrder: $('input[name="minOrder"]').val(),
               maxOrder: $('input[name="maxOrder"]').val(),
               productLocation: $('input[name="productLocation"]').val(),
               deliveryCost: $('input[name="deliveryCost"]').val() == "" ? 0 : $('input[name="deliveryCost"]')
                  .val(),
               exchangeCost: $('input[name="exchangeCost"]').val() == "" ? 0 : $('input[name="exchangeCost"]')
                  .val(),
               returnCost: $('input[name="returnCost"]').val() == "" ? 0 : $('input[name="returnCost"]').val(),
               deliveryService: $('select[name="deliveryService"]').val(),
               imgInfo: $('#Imginform').val(),
               productImgCon: $('#productImgCon').val(),
               option: [{
                     optionName1: $('input[id="optionName0"]').val(),
                     optionValue1: $('input[id="optionVal0"]').val(),
                  },
                  {
                     optionName1: $('input[id="optionName1"]').val(),
                     optionValue1: $('input[id="optionVal1"]').val(),
                  },
                  {
                     optionName1: $('input[id="optionName2"]').val(),
                     optionValue1: $('input[id="optionVal2"]').val(),
                  },
               ],
               optionDetail: [

               ],
               expire: Date.now() + 7200000,
               catemenu: [

               ],
               optionNum: $('#optionNum').val(),


            }
          //let optionDetail = [];
          // 옵션 저장
          let leng = $('#optiontab').find('tr').length;
          for (let i = 0; i < leng; i++) {
             let box = {
                optionLast0: $('input[id="optionLast' + i + '"]').val(),
                optionPrice0: $('input[id="optionPrice' + i + '"]').val(),
                optionCount0: $('input[id="optionCount' + i + '"]').val(),
                minOrder0: $('input[id="minOrder' + i + '"]').val(),
                maxOrder0: $('input[id="maxOrder' + i + '"]').val()
             };
             obj.optionDetail.push(box);
          }

          // 카테고리 저장
          let catemenu1 = {};
          $('#categoryCode').find('option').map(function(){
             if($('#categoryCode option:selected').val() == $(this).val()){
                catemenu1["0"+$(this).text()] = $(this).val();
             }else{
                catemenu1[$(this).text()] = $(this).val();
             }
             //console.log($(this):selected);

          });
          obj.catemenu.push(catemenu1);

          let catemenu2 = {};
          $('#categoryCode01').find('option').map(function(){
             if($('#categoryCode01 option:selected').val() == $(this).val()){
                catemenu2["0"+$(this).text()] = $(this).val();
             }else{
                catemenu2[$(this).text()] = $(this).val();
             }

          });

          obj.catemenu.push(catemenu2);

          let catemenu3 = {};
          $('#categoryCode02').find('option').map(function(){
             if($('#categoryCode02 option:selected').val() == $(this).val()){
                catemenu3["0"+$(this).text()] = $(this).val();
             }else{
                catemenu3[$(this).text()] = $(this).val();
             }
          });

          obj.catemenu.push(catemenu3);

          let catemenu4 = {};
          $('#categoryCode03').find('option').map(function(){
             if($('#categoryCode03 option:selected').val() == $(this).val()){
                catemenu4["0"+$(this).text()] = $(this).val();
             }else{
                catemenu4[$(this).text()] = $(this).val();
             }
          });

          obj.catemenu.push(catemenu4);
            window.localStorage.setItem("product", JSON.stringify(obj));
             /* window.location.href = '/modifyProductContent?productCode=' + productCode; */
             
            var _width = '700';
		    var _height = '700';
		 
		    // 팝업을 가운데 위치시키기 위해 아래와 같이 값 구하기
		    var _left = Math.ceil(( window.screen.width - _width )/2);
		    var _top = Math.ceil(( window.screen.height - _height )/2); 
		    
		    let child = window.open('/seller/modifyProductContent?productCode=' + productCode, 'productcontent', 'width='+ _width +', height='+ _height +', left=' + _left + ', top='+ _top);
	        
         });
       
         
        // 임시저장
         $('.storage').on('click',function(e){

         });

         // 수정 이벤트
         $('.submit').on('click',function(e){
        	 e.preventDefault();

             let detailData = JSON.parse(localStorage.getItem("detail"));
             if(detailData != null){
                let textarea = $('<textarea>' + detailData.content + '</textarea>');
                textarea.css("display", "none");
                textarea.attr("name", "productContent");
                $("#updateForm").prepend(textarea);
                for(let i = 0; i<detailData.img.length; i++){
                   let divTab = $('<div/>');
                   let obj = detailData.img[i];
                   for(var key in obj){
                      let input = $('<input/>');
                      $(input).val(obj[key]);
                      input.attr("type", "hidden");
                      input.attr("name","imgsVO["+i+"]."+key);
                      divTab.append(input);
                   }
                   $(divTab).appendTo($("#updateForm"));

             }
                test22 ='/modifyProductContent?productCode='+ productCode
                
                
             }



             if (!idChk($("#productName").val())) {
                return;
             }

             if (!productCostChk($('#productCost').val())) {
                return;
             }

             if (!salePriceChk($('#salePrice').val())) {
                return;
             }

             if ($('#optCnt').val() == 0) {
                if (!productCountChk($('#productCount').val())) {
                   return;
                }
             }

             if ($('#optCnt').val() != 0) {
                if (!optionChk()) {
                   return;
                }

                if (!changeOption()) {
                   return;
                }
             }

             let optionDetailChk = $("#optiontab tr");
             let chk = "N";

             $(optionDetailChk).each(function (idx, item) {
                let n = 0;
                chk = "N";
                let count = 0;
                let min = 0;
                let max = 0;
                let inputBox = $(item).find("input");
                for (let i = 0; i < inputBox.length; i++) {
                   let tbox = inputBox[i];
                   if ($(tbox).attr("id") == "optionPrice" + idx) {
                      if (!optPrice($(tbox).val())) {
                         $(tbox).focus();
                         break;
                      }
                      n++
                   }
                   
                   if ($(tbox).attr("id") == "optionCount" + idx) {
                      if (!optCount($(tbox).val())) {
                         count = $(tbox).val();
                         console.log("count" + count);
                         $(tbox).focus();
                         break;
                      }
                      console.log(count);
                      n++
                   }
                   if ($(tbox).attr("id") == "minOrder" + idx) {
                      min = $(tbox).val();
                      if (!optMin($(tbox).val())) {
                         $(tbox).focus();
                         break;
                      }
                      console.log(min);
                      // if($(tbox).val() <  count){
                      //    $(tbox).focus();
                      //    alert("최소수량이 수량보다 많습니다.");
                      //    break;
                      // }
                      n++
                   }
                   if ($(tbox).attr("id") == "maxOrder" + idx) {
                      max = $(tbox).val();
                      if (!optMax($(tbox).val())) {
                         $(tbox).focus();
                         break;
                      }
                      
                      // if($(tbox).val() >  count){
                      //    $(tbox).focus();
                      //    alert("최대수량이 수량보다 많습니다.");
                      //    break;
                      // }
                      // if($(tbox).val() >  min){
                      //    $(tbox).focus();
                      //    alert("최대수량이 최소수량보다 적습니다.");
                      //    break;
                      // }
                      n++
                   }
                }
                if (n != 4) {
                   return false;
                }
                chk = "Y";
             })

             if (chk == "N") {
                return;
             }

             // 옵션 검사 해야함
             let inputfile = $('#imgName');
             let files = inputfile[0].files;
             if (files.length == 0) {
                alert("대표이미지를 등록해주세요");
                inputfile.focus();
                return;
             }

             if ($("#productImgCon").val() == "") {
                alert("이미지 대체 텍스트를 입력해주세요");
                inputfile.focus();
                return;
             }
             let chk2 = $("#productImgCon").val();
             if (chk2.length > 100) {
                alert("이미지 대체 텍스트 100자 이내입니다.");
                inputfile.focus();
                return;
             }

             if (!imgChk(files[0].name, files[0].size)) {
                inputfile.focus();
                return;
             }

             if ($("#insertForm").find('textarea[name="productContent"]').length == 0) {
                alert("상세 설명을 입력해주세요");
                return;
             }
             if ($('textarea[name="productContent"]').val() == "") {
                alert("상세 설명을 적어주세요");
                return;
             }

             let detailImg = $(".imgName");
             let detailContent = $(".imgContet");


             for (let x = 0; x < detailImg.length; x++) {
                let chk1 = detailImg[x];
                let chk2 = detailContent[x];

                if ($(chk1).val == "") {
                   alert("상세 설명 이미지를 넣어주세요");
                   return;
                }
                if ($(chk2).val() == "") {
                   alert("상세 설명 이미지 대체텍스트를 넣어주세요");
                }
             }

             // 브랜드 
             if (!brandChk($("#productBrand").val())) {
                return;
             }

             if (!orginchk($("#productOrigin").val())) {
                return;
             }

             if (!makerChk($("#productMakeorigin").val())) {
                return;
             }
             if(!locationChk($("#productLocation").val())){
                return;
             }

             if (!deliveryCostChk($("#deliveryCost").val())) {
                return;
             }

             if (!exchangeCostChk($("#exchangeCost").val())) {
                return;
             }

             if (!returnCost($("#returnCost").val())) {
                return;
             }

             if ($("#deliveryService").val() == "") {
                alert("택배사를 선택해주세요");
                $("#deliveryService").focus();
                return;
             }
             
             test22 ='/modifyProductContent?productCode='+ productCode
             $('#updateForm').submit();
         })
		 
		
	
		

		   

      </script>
<style>
			.modal img{
				width:100%;
			}
			
			.tableWrapper {

			    overflow: auto;
			    width: 960px;
			}
		
			#userListTable {
			    border-collapse: collapse;
			}
			
			#userListTable th {
			    position: sticky;
			    top: 0px;
			    background-color:cornflowerblue;
			}
		</style>


   </div>
   

</html>